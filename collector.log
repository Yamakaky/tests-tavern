2022-09-16T17:14:21.473Z	info	service/telemetry.go:102	Setting up own telemetry...
2022-09-16T17:14:21.473Z	info	service/telemetry.go:137	Serving Prometheus metrics	{"address": ":8888", "level": "basic"}
2022-09-16T17:14:21.473Z	info	components/components.go:30	In development component. May change in the future.	{"kind": "exporter", "data_type": "traces", "name": "logging", "stability": "in development"}
2022-09-16T17:14:21.474Z	info	extensions/extensions.go:42	Starting extensions...
2022-09-16T17:14:21.474Z	info	pipelines/pipelines.go:74	Starting exporters...
2022-09-16T17:14:21.474Z	info	pipelines/pipelines.go:78	Exporter is starting...	{"kind": "exporter", "data_type": "traces", "name": "logging"}
2022-09-16T17:14:21.474Z	info	pipelines/pipelines.go:82	Exporter started.	{"kind": "exporter", "data_type": "traces", "name": "logging"}
2022-09-16T17:14:21.474Z	info	pipelines/pipelines.go:86	Starting processors...
2022-09-16T17:14:21.474Z	info	pipelines/pipelines.go:98	Starting receivers...
2022-09-16T17:14:21.474Z	info	pipelines/pipelines.go:102	Receiver is starting...	{"kind": "receiver", "name": "otlp", "pipeline": "traces"}
2022-09-16T17:14:21.474Z	info	otlpreceiver/otlp.go:70	Starting GRPC server on endpoint 0.0.0.0:4317	{"kind": "receiver", "name": "otlp", "pipeline": "traces"}
2022-09-16T17:14:21.474Z	info	otlpreceiver/otlp.go:88	Starting HTTP server on endpoint 0.0.0.0:4318	{"kind": "receiver", "name": "otlp", "pipeline": "traces"}
2022-09-16T17:14:21.474Z	info	pipelines/pipelines.go:106	Receiver started.	{"kind": "receiver", "name": "otlp", "pipeline": "traces"}
2022-09-16T17:14:21.474Z	info	service/collector.go:215	Starting otelcol...	{"Version": "0.56.0", "NumCPU": 24}
2022-09-16T17:14:21.474Z	info	service/collector.go:128	Everything is ready. Begin running and processing data.
2022-09-16T17:14:23.503Z	info	TracesExporter	{"kind": "exporter", "data_type": "traces", "name": "logging", "#spans": 5}
2022-09-16T17:14:23.503Z	info	ResourceSpans #0
Resource SchemaURL: 
Resource labels:
     -> telemetry.sdk.language: STRING(python)
     -> telemetry.sdk.name: STRING(opentelemetry)
     -> telemetry.sdk.version: STRING(1.12.0)
     -> service.name: STRING(tests-tavern)
     -> process.runtime.name: STRING(cpython)
     -> process.runtime.version: STRING(3.10.7)
     -> process.runtime.description: STRING(3.10.7 (main, Sep  6 2022, 21:22:27) [GCC 12.2.0])
     -> process.pid: INT(17796)
     -> process.executable.name: STRING(pytest)
     -> process.executable.path: STRING(/usr/bin/python3.10)
     -> process.command_line: STRING(/home/mikael/dev/python/tests-tavern/.venv/bin/python /home/mikael/dev/python/tests-tavern/.venv/bin/pytest --export-traces --tavern-global-cfg cfg.yaml)
     -> process.command: STRING(/home/mikael/dev/python/tests-tavern/.venv/bin/python)
     -> process.command_args: STRING(/home/mikael/dev/python/tests-tavern/.venv/bin/pytest --export-traces --tavern-global-cfg cfg.yaml)
     -> process.owner: STRING(mikael)
     -> service.version: STRING(45b93a418fd24f41dec706d2a7ba684ad2206cd1)
ScopeSpans #0
ScopeSpans SchemaURL: 
InstrumentationScope pytest-opentelemetry 
Span #0
    Trace ID       : 52dfe95593ae346065118ef2a30b3edc
    Parent ID      : 7fed9785316051ef
    ID             : e80a0358d403f944
    Name           : Get some fake data from the JSON placeholder API[1]
    Kind           : SPAN_KIND_INTERNAL
    Start time     : 2022-09-16 17:14:23.250836733 +0000 UTC
    End time       : 2022-09-16 17:14:23.406665411 +0000 UTC
    Status code    : STATUS_CODE_ERROR
    Status message : <class 'tavern.util.exceptions.TestFailError'>: Test 'Make sure we have the right ID' failed:
- Key mismatch: (expected["userId"] = '2' (type = <class 'int'>), actual["userId"] = '1' (type = <class 'int'>))
Attributes:
     -> code.filepath: STRING(tests/test_otel.tavern.yaml)
     -> code.function: STRING(Get some fake data from the JSON placeholder API[1])
     -> pytest.nodeid: STRING(tests/test_otel.tavern.yaml::Get some fake data from the JSON placeholder API[1])
     -> pytest.keywords: STRING(<NodeKeywords for node <YamlItem Get some fake data from the JSON placeholder API[1]>>)
     -> pytest.span_type: STRING(test)
Events:
SpanEvent #0
     -> Name: exception
     -> Timestamp: 2022-09-16 17:14:23.40646484 +0000 UTC
     -> DroppedAttributesCount: 0
     -> Attributes:
         -> exception.type: STRING(TestFailError)
         -> exception.message: STRING(Test 'Make sure we have the right ID' failed:
- Key mismatch: (expected["userId"] = '2' (type = <class 'int'>), actual["userId"] = '1' (type = <class 'int'>)))
         -> exception.stacktrace: STRING(Format variables:
  var = '1'

Source test stage (line 13):
  - name: Make sure we have the right ID
    request:
      url: "https://jsonplaceholder.typicode.com/posts/{var}"
      method: GET
    response:
      status_code: 200
      json:
        id: 1
        userId: 2
        title: "sunt aut facere repellat provident occaecati excepturi optio reprehenderit"
        body: "quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto"

Formatted stage:
  name: Make sure we have the right ID
  request:
    method: GET
    url: https://jsonplaceholder.typicode.com/posts/1
  response:
    json:
      body: 'quia et suscipit
        suscipit recusandae consequuntur expedita et cum
        reprehenderit molestiae ut ut quas totam
        nostrum rerum est autem sunt rem eveniet architecto'
      id: 1
      title: sunt aut facere repellat provident occaecati excepturi optio reprehenderit
      userId: 2
    status_code: 200

Errors:
E   tavern.util.exceptions.TestFailError: Test 'Make sure we have the right ID' failed:
    - Key mismatch: (expected["userId"] = '2' (type = <class 'int'>), actual["userId"] = '1' (type = <class 'int'>)))
         -> exception.escaped: STRING(False)
Span #1
    Trace ID       : 52dfe95593ae346065118ef2a30b3edc
    Parent ID      : 7fed9785316051ef
    ID             : 562b786f23f4a656
    Name           : Get some fake data from the JSON placeholder API[2]
    Kind           : SPAN_KIND_INTERNAL
    Start time     : 2022-09-16 17:14:23.406796081 +0000 UTC
    End time       : 2022-09-16 17:14:23.485239241 +0000 UTC
    Status code    : STATUS_CODE_ERROR
    Status message : <class 'tavern.util.exceptions.TestFailError'>: Test 'Make sure we have the right ID' failed:
- Key mismatch: (expected["title"] = 'sunt aut facere repellat provident occaecati excepturi optio reprehenderit' (type = <class 'tavern.util.formatted_str.FormattedString'>), actual["title"] = 'qui est esse' (type = <class 'str'>))
Attributes:
     -> code.filepath: STRING(tests/test_otel.tavern.yaml)
     -> code.function: STRING(Get some fake data from the JSON placeholder API[2])
     -> pytest.nodeid: STRING(tests/test_otel.tavern.yaml::Get some fake data from the JSON placeholder API[2])
     -> pytest.keywords: STRING(<NodeKeywords for node <YamlItem Get some fake data from the JSON placeholder API[2]>>)
     -> pytest.span_type: STRING(test)
Events:
SpanEvent #0
     -> Name: exception
     -> Timestamp: 2022-09-16 17:14:23.485073541 +0000 UTC
     -> DroppedAttributesCount: 0
     -> Attributes:
         -> exception.type: STRING(TestFailError)
         -> exception.message: STRING(Test 'Make sure we have the right ID' failed:
- Key mismatch: (expected["title"] = 'sunt aut facere repellat provident occaecati excepturi optio reprehenderit' (type = <class 'tavern.util.formatted_str.FormattedString'>), actual["title"] = 'qui est esse' (type = <class 'str'>)))
         -> exception.stacktrace: STRING(Format variables:
  var = '2'

Source test stage (line 13):
  - name: Make sure we have the right ID
    request:
      url: "https://jsonplaceholder.typicode.com/posts/{var}"
      method: GET
    response:
      status_code: 200
      json:
        id: 1
        userId: 2
        title: "sunt aut facere repellat provident occaecati excepturi optio reprehenderit"
        body: "quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto"

Formatted stage:
  name: Make sure we have the right ID
  request:
    method: GET
    url: https://jsonplaceholder.typicode.com/posts/2
  response:
    json:
      body: 'quia et suscipit
        suscipit recusandae consequuntur expedita et cum
        reprehenderit molestiae ut ut quas totam
        nostrum rerum est autem sunt rem eveniet architecto'
      id: 1
      title: sunt aut facere repellat provident occaecati excepturi optio reprehenderit
      userId: 2
    status_code: 200

Errors:
E   tavern.util.exceptions.TestFailError: Test 'Make sure we have the right ID' failed:
    - Key mismatch: (expected["title"] = 'sunt aut facere repellat provident occaecati excepturi optio reprehenderit' (type = <class 'tavern.util.formatted_str.FormattedString'>), actual["title"] = 'qui est esse' (type = <class 'str'>)))
         -> exception.escaped: STRING(False)
Span #2
    Trace ID       : 52dfe95593ae346065118ef2a30b3edc
    Parent ID      : 7fed9785316051ef
    ID             : 9bf810a14fd7b8de
    Name           : test_fn
    Kind           : SPAN_KIND_INTERNAL
    Start time     : 2022-09-16 17:14:23.485341811 +0000 UTC
    End time       : 2022-09-16 17:14:23.485874412 +0000 UTC
    Status code    : STATUS_CODE_OK
    Status message : 
Attributes:
     -> code.filepath: STRING(tests/test_pytest.py)
     -> code.function: STRING(test_fn)
     -> pytest.nodeid: STRING(tests/test_pytest.py::test_fn)
     -> pytest.keywords: STRING(<NodeKeywords for node <Function test_fn>>)
     -> pytest.span_type: STRING(test)
Span #3
    Trace ID       : 52dfe95593ae346065118ef2a30b3edc
    Parent ID      : 7fed9785316051ef
    ID             : 99b72ea2adffa714
    Name           : test_class
    Kind           : SPAN_KIND_INTERNAL
    Start time     : 2022-09-16 17:14:23.485941252 +0000 UTC
    End time       : 2022-09-16 17:14:23.486352052 +0000 UTC
    Status code    : STATUS_CODE_OK
    Status message : 
Attributes:
     -> code.filepath: STRING(tests/test_pytest.py)
     -> code.function: STRING(test_class)
     -> pytest.nodeid: STRING(tests/test_pytest.py::TestClass::test_class)
     -> pytest.keywords: STRING(<NodeKeywords for node <Function test_class>>)
     -> pytest.span_type: STRING(test)
     -> code.lineno: INT(4)
Span #4
    Trace ID       : 52dfe95593ae346065118ef2a30b3edc
    Parent ID      : 
    ID             : 7fed9785316051ef
    Name           : test run
    Kind           : SPAN_KIND_INTERNAL
    Start time     : 2022-09-16 17:14:23.230511009 +0000 UTC
    End time       : 2022-09-16 17:14:23.486398302 +0000 UTC
    Status code    : STATUS_CODE_UNSET
    Status message : 
Attributes:
     -> pytest.span_type: STRING(run)
	{"kind": "exporter", "data_type": "traces", "name": "logging"}
2022-09-16T17:14:25.754Z	info	service/collector.go:159	Received signal from OS	{"signal": "interrupt"}
2022-09-16T17:14:25.754Z	info	service/collector.go:231	Starting shutdown...
2022-09-16T17:14:25.754Z	info	pipelines/pipelines.go:118	Stopping receivers...
2022-09-16T17:14:25.756Z	info	pipelines/pipelines.go:125	Stopping processors...
2022-09-16T17:14:25.756Z	info	pipelines/pipelines.go:132	Stopping exporters...
2022-09-16T17:14:25.756Z	info	extensions/extensions.go:56	Stopping extensions...
